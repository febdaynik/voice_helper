<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>VoiceHelper</title>
	<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
	
	<div class="wrapper">
		<main class="page">
			<div class="container">
				<div class="content">
					<a href="/"><h1>Voice Helper</h1></a>
					<div class="content-block">

					<form class="voiceform space" action="" method="post" enctype = "multipart/form-data">
						<input id="file_input" class="input__file" type="file" name="file">
						<div class="input__file-block">
							<label for="file_input" class="file_input-button">
								<div class="icon-file">
									<svg id="Flat" height="512" viewBox="0 0 512 512" width="512" xmlns="http://www.w3.org/2000/svg"><path d="m392 488h-272a48 48 0 0 1 -48-48v-368a48 48 0 0 1 48-48h224l96 96v320a48 48 0 0 1 -48 48z" fill="#cfd2fc"/><path d="m72 360h368a0 0 0 0 1 0 0v80a48 48 0 0 1 -48 48h-272a48 48 0 0 1 -48-48v-80a0 0 0 0 1 0 0z" fill="#5153ff"/><g fill="#8690fa"><path d="m440 120h-48a48 48 0 0 1 -48-48v-48z"/><path d="m192 304a8 8 0 0 1 -8-8v-144a8 8 0 0 1 16 0v144a8 8 0 0 1 -8 8z"/><path d="m256 256a8 8 0 0 1 -8-8v-48a8 8 0 0 1 16 0v48a8 8 0 0 1 -8 8z"/></g><path d="m160 272a8 8 0 0 1 -8-8v-80a8 8 0 0 1 16 0v80a8 8 0 0 1 -8 8z" fill="#5153ff"/><path d="m224 272a8 8 0 0 1 -8-8v-80a8 8 0 0 1 16 0v80a8 8 0 0 1 -8 8z" fill="#5153ff"/><path d="m320 304a8 8 0 0 1 -8-8v-144a8 8 0 0 1 16 0v144a8 8 0 0 1 -8 8z" fill="#8690fa"/><path d="m352 272a8 8 0 0 1 -8-8v-80a8 8 0 0 1 16 0v80a8 8 0 0 1 -8 8z" fill="#5153ff"/><path d="m288 272a8 8 0 0 1 -8-8v-80a8 8 0 0 1 16 0v80a8 8 0 0 1 -8 8z" fill="#5153ff"/><path d="m128 240a8 8 0 0 1 -8-8v-16a8 8 0 0 1 16 0v16a8 8 0 0 1 -8 8z" fill="#8690fa"/><path d="m384 240a8 8 0 0 1 -8-8v-16a8 8 0 0 1 16 0v16a8 8 0 0 1 -8 8z" fill="#8690fa"/><path d="m353.94 384.239a8 8 0 0 0 -9.7 5.821l-8.24 32.956-8.239-32.956a8 8 0 1 0 -15.522 3.88l16 64a8 8 0 0 0 15.522 0l16-64a8 8 0 0 0 -5.821-9.701z" fill="#fff"/><path d="m271.491 389.191a8 8 0 0 0 -14.982 0l-24 64a8 8 0 0 0 14.982 5.618l4.053-10.809h24.912l4.053 10.809a8 8 0 0 0 14.982-5.618zm-13.947 42.809 6.456-17.216 6.456 17.216z" fill="#fff"/><path d="m208.992 384.062a8 8 0 0 0 -8.93 6.946l-3.625 29-4.848-14.541a8 8 0 0 0 -15.178 0l-4.848 14.541-3.625-29a8 8 0 1 0 -15.876 1.984l8 64a8 8 0 0 0 15.527 1.538l8.411-25.23 8.411 25.232a8 8 0 0 0 7.589 5.468q.394 0 .793-.039a8 8 0 0 0 7.15-6.969l8-64a8 8 0 0 0 -6.951-8.93z" fill="#fff"/></svg>
								</div>
								<span class="input__file-button-text">Выбрать файл</span>
							</label>
						</div>
					</form>
					<div class="loader">
						<span></span>
						<span></span>
						<span></span>
					</div>
					{% if message %}
					<div class="block-message space">
						<span class="label-audio">Текст из файла:</span><p class="text-audio">{{ message }}</p>
						<span class="label-audio">Аудио</span><div class="block-audio">
							<audio controls>
								<source src="{{ fn }}" type="audio/wav">
							</audio>
						</div>
					</div>
					{% if answer_server[0] %}
					<div class="block-message space">
						<div class="label-audio block-link-task">
							<p>{{ answer_server[0] }}</p>
							<p class="error">{{ answer_server[2] }}</p>
							<a href="{{ answer_server[1] }}">Ссылка на задачу</a>
						</div>
					</div>
					{% endif %}

					{% endif %}
					</div>
				</div>
			</div>
		</main>

	</div>

	<script>
		
		let input = document.querySelector('.input__file');

		let label = input.nextElementSibling,
		labelVal = label.querySelector('.input__file-button-text').innerText;

		input.addEventListener('change', function (e) {
		let countFiles = this.files[0].name;
		console.log(this.files[0])
		if (this.files[0].type.split("/")[0] == "audio"){
			if (countFiles){ label.querySelector('.input__file-button-text').innerText =countFiles; document.querySelector('.icon-file').className = 'icon-file sendfile'; document.querySelector('.loader').className = 'loader start'; document.querySelector('.voiceform').submit()}
			else{ label.querySelector('.input__file-button-text').innerText = labelVal; document.querySelector('.icon-file').className = 'icon-file'}
		}
		else{ label.querySelector('.input__file-button-text').innerText = "Файл не подходит"; document.querySelector('.icon-file').className = 'icon-file'}
		});


	</script>
	<!-- <script>document.write('<script src="http://' + (location.host || 'localhost').split(':')[0] + ':35729/livereload.js?snipver=1"></' + 'script>')</script> -->
</body>
</html>	